<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="calendar(reservesData)">

<head>
  <meta charset='utf-8' />
  <link href='../lib/main.css' rel='stylesheet' />
  <script src='../lib/main.js'></script>
  <script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
    var datas = /*[[${reservesData}]]*/[];

    /*]]>*/
    events = []
    // function cvtTime12to24TimeShift(timestr) {
    //   timestrArr = timestr.split("T")
    //   date = timestrArr[0]
    //   time = timestrArr[1]
    //   timestrArr_2 = time.split(":")
    //   hr = timestrArr_2[0]
    //   if (hr )
    // }
    for (var i = 0; i < datas.length; i++) {
      console.log(datas)
      events.push({
        title: datas[i].title,
        start: datas[i].startDateTime,
        end: datas[i].endDateTime,
        extendedProps: {
          description: datas[i].description,
          reserverName: datas[i].reserver.staffName,
          roomName: datas[i].room.roomName
        }
      })
    }
    document.addEventListener('DOMContentLoaded', function () {
      var calendarEl = document.getElementById('calendar');

      var calendar = new FullCalendar.Calendar(calendarEl, {
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        eventDidMount: function (info) {
          console.log("render")
        },
        initialDate: '2020-09-12',
        navLinks: true, // can click day/week names to navigate views
        selectable: true,
        selectMirror: true,
        // select: function(arg) {
        //   var title = prompt('Event Title:');
        //   if (title) {
        //     calendar.addEvent({
        //       title: title,
        //       start: arg.start,
        //       end: arg.end,
        //       allDay: arg.allDay
        //     })
        //   }
        //   calendar.unselect()
        // },
        eventClick: function (arg) {
          console.log("event",events)
          console.log(arg.event.start)
          console.log(arg.event.end)

          console.log(arg.event.extendedProps.reserverName)
          console.log(arg.event.extendedProps.roomName)

          $('#c-title').html(arg.event.title)
          $('#c-date').html(arg.event.start.toTimeString().split(" ")[0] + " - " + arg.event.end.toTimeString().split(" ")[0])
          $('#c-description').html(arg.event.extendedProps.description)
          $('#c-reserver').text("Reserver : " + arg.event.extendedProps.reserverName)

          if ($('#reserve-info-card').is(":visible")) {
            $('#reserve-info-card').slideUp("fast")
            $('#reserve-info-card').slideUp("slow")
          }
          $('#reserve-info-card').slideDown("slow")


        },
        editable: true,
        dayMaxEvents: true, // allow "more" link when too many events
        events: events
      });
      calendar.render();
    });
  </script>
  <style>
    body {
      margin: 40px 10px;
      padding: 0;
      font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
      font-size: 14px;
    }

    #calendar {
      max-width: 1100px;
      margin: 0 auto;
    }
  </style>
</head>

<body>
  <div class="ui  grid">
    <div class="eleven wide column">
      <div class="ui fluid card">

        <div class="content">
          <div id='calendar'></div>
        </div>
      </div>
    </div>

    <div class="four wide column">
      <div class="ui fluid card" id="reserve-info-card">
        <script>
          $('#reserve-info-card').hide("slow")
        </script>
        <div class="image">
          <img src="https://image.makewebeasy.net/makeweb/0/bXtUs9mSz/LRoom/Room_E_18.jpg">
        </div>
        <div class="content">
          <a class="header" id="c-title">Kristy</a>
          <div class="meta">
            <span class="date" id="c-date">Joined in 2013</span>
          </div>
          <div class="description" id="c-description">
            Kristy is an art director living in New York.
          </div>
        </div>
        <div class="extra content">
          <a>
            <i class="user icon"></i>
            <div id="c-reserver" style="display: inline-block;">
              22 Friends
            </div>
          </a>
        </div>
      </div>

    </div>



</body>

</html>